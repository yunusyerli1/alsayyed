<div class="mt-3">
  <h1>1.Liste</h1>
  <form class="mt-5" [formGroup]="listFirstForm" (ngSubmit)="onSubmit()">
    <div class="row row-cols-4  mb-3">
      <div class="col mb-3">
        <label for="category">Category:</label>
        <select class="form-select" id="category" (change)="changeCategory($event)" formControlName="category">
          <option selected disabled>Choose One...</option>
          <option [value]="category" *ngFor="let category of categories">{{category}}</option>
        </select>
      </div>

      <div class="col mb-3">
        <label for="category">Design Brand:</label>
        <input type="text" class="form-control" id="designBrand" placeholder="RSDX"  formControlName="designBrand">
      </div>

      <div class="col mb-3">
        <label for="quantity">Miktar:</label>
        <input type="number" class="form-control" id="quantity" placeholder="20"  formControlName="quantity">
      </div>

      <div class="col mb-3">
        <label for="componentType">Component Type:</label>
        <select class="form-select" id="componentType" (change)="changeComponentType($event)" formControlName="componentType">
          <option selected disabled>Choose One...</option>
          <option value="Single Component">Single Component</option>
          <option value="Set">Set</option>
          <option value="Set-Component">Set Component</option>
        </select>
      </div>

      <div class="col mb-3">
        <label for="rawMaterial">Raw Material:</label>
        <select class="form-select" id="rawMaterial" (change)="changeRawMaterial($event)" formControlName="rawMaterial">
          <option selected disabled>Choose One...</option>
          <option [value]="rawMaterial.YELLOW_RESIN">{{rawMaterial.YELLOW_RESIN}}</option>
          <option [value]="rawMaterial.RED_RESIN">{{rawMaterial.RED_RESIN}}</option>
        </select>
      </div>

      <div class="col mb-3">
        <label for="style">Style:</label>
        <select class="form-select" id="style" (change)="changeStyle($event)" formControlName="style">
          <option selected disabled>Choose One...</option>
          <option value="With Stone">With Stone</option>
          <option value="No Stone">No Stone</option>
        </select>
      </div>

      <div class="col mb-3">
        <label for="dimensionDefault">Default Dimension:</label>
        <input type="number" class="form-control" id="dimensionDefault" placeholder="4.5"  formControlName="dimensionDefault">
      </div>

      <div class="col mb-3">
        <label for="fullsetAttribute">Fullset Attribute:</label>
        <input type="text" class="form-control" id="fullsetAttribute" placeholder="Bangle"  formControlName="fullsetAttribute">
      </div>
    </div>

    <div class="d-flex justify-content-end gap-3 mb-3">
      <button class="btn btn-secondary px-3" (click)="exportToExcel()">Export</button>
      <button class="btn btn-secondary px-3" type="submit" [disabled]="!listFirstForm.valid">Submit</button>
    </div>

  </form>
</div>

<div class="mt-5" style="max-height: 400px; overflow-y: auto;">

  <table class="table table-striped" id="excel-table" *ngIf="(products$ | async) as products">
    <thead>
      <tr>
        <th scope="col">Category</th>
        <th scope="col">Name</th>
        <th scope="col">Component Type</th>
        <th scope="col">Raw Material</th>
        <th scope="col">Style</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of products">
        <td>{{item.category}}</td>
        <td>{{item.designBrand}}</td>
        <td>{{item.componentType}}</td>
        <td>{{item.rawMaterial}}</td>
        <td>{{item.style}}</td>
        <td>{{item.dimensionDefault}}</td>
        <td>{{item.fullsetAttribute}}</td>
      </tr>

    </tbody>
  </table>
  <button (click)="exportTableToExcel()">Export to Excel</button>
</div>
