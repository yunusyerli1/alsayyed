<div class="mt-3">
  <h1>1.Liste</h1>
  <form class="mt-5" [formGroup]="listFirstForm" (ngSubmit)="onSubmit()">
    <div class="row row-cols-4">
      <div class="col mb-3">
        <label for="category">Category:</label>
        <select class="form-select" id="category" (change)="changeSelection($event, 'category')" formControlName="category">
          <option selected disabled>Choose One...</option>
          <option [value]="category" *ngFor="let category of categories">{{category}}</option>
        </select>
      </div>

      <div class="col mb-3">
        <label for="category">Design Brand:</label>
        <input type="text" class="form-control" id="designBrand" placeholder="RSDX"  formControlName="designBrand">
      </div>

      <div class="col mb-3">
        <label for="quantity">Miktar:</label>
        <input type="number" class="form-control" id="quantity" placeholder="20"  formControlName="quantity">
      </div>

      <div class="col mb-3">
        <label for="rawMaterial">Raw Material:</label>
        <select class="form-select" id="rawMaterial" (change)="changeSelection($event, 'rawMaterial')" formControlName="rawMaterial">
          <option selected disabled>Choose One...</option>
          <option [value]="rawMaterial.YELLOW_RESIN">{{rawMaterial.YELLOW_RESIN}}</option>
          <option [value]="rawMaterial.RED_RESIN">{{rawMaterial.RED_RESIN}}</option>
        </select>
      </div>

      <div class="col mb-3">
        <label for="style">Style:</label>
        <select class="form-select" id="style" (change)="changeSelection($event, 'style')" formControlName="style">
          <option selected disabled>Choose One...</option>
          <option value="With Stone">With Stone</option>
          <option value="No Stone">No Stone</option>
        </select>
      </div>

      <div class="col mb-3">
        <label for="dimensionDefault">Default Dimension:</label>
        <input type="number" class="form-control" id="dimensionDefault" placeholder="4.5"  formControlName="dimensionDefault">
      </div>

      <div class="col mb-3">
        <label for="fullsetAttribute">Fullset Attribute:</label>
        <input type="text" class="form-control" id="fullsetAttribute" placeholder="Bangle"  formControlName="fullsetAttribute">
      </div>

    </div>

    <div class="row" *ngIf="!isTagInputHidden">
      <div class="col-6">
        <label>Postfix</label>
        <app-chips-tag-input (valuesToBeSent)="setTags($event)"></app-chips-tag-input>
      </div>
    </div>



    <div class="d-flex justify-content-end gap-3 mb-3">
      <button class="btn btn-secondary px-3" (click)="exportToExcel()">Export</button>
      <button class="btn btn-secondary px-3" type="submit" [disabled]="!listFirstForm.valid">Add</button>
    </div>

  </form>

</div>

<div class="mt-5" style="max-height: 500px; overflow-y: auto;" *ngIf="(products$ | async) as products">

  <table class="table table-striped" id="excel-table" *ngIf="products.length">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Category</th>
        <th scope="col">Name</th>
        <th scope="col">Component Type</th>
        <th scope="col">Raw Material</th>
        <th scope="col">Style</th>
        <th scope="col">Dimension</th>
        <th scope="col">Fullset Attribute</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of products; let i = index">
        <td>{{i + 1}}</td>
        <td>{{item.category}}</td>
        <td>{{item.designBrand}}</td>
        <td>{{item.componentType}}</td>
        <td>{{item.rawMaterial}}</td>
        <td>{{item.style}}</td>
        <td>{{item.dimensionDefault}}</td>
        <td>{{item.fullsetAttribute}}</td>
      </tr>

    </tbody>
  </table>
  <button (click)="exportTableToExcel()">Export to Excel</button>
</div>
